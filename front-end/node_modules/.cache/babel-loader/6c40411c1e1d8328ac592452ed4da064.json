{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n/* eslint-disable no-underscore-dangle */\n\n\nvar _defaults = require('lodash/defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nvar _shallowEqual = require('./shallowEqual');\n\nvar _shallowEqual2 = _interopRequireDefault(_shallowEqual);\n\nvar _EnterLeaveCounter = require('./EnterLeaveCounter');\n\nvar _EnterLeaveCounter2 = _interopRequireDefault(_EnterLeaveCounter);\n\nvar _BrowserDetector = require('./BrowserDetector');\n\nvar _OffsetUtils = require('./OffsetUtils');\n\nvar _NativeDragSources = require('./NativeDragSources');\n\nvar _NativeTypes = require('./NativeTypes');\n\nvar NativeTypes = _interopRequireWildcard(_NativeTypes);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar HTML5Backend = function () {\n  function HTML5Backend(manager) {\n    _classCallCheck(this, HTML5Backend);\n\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.context = manager.getContext();\n    this.sourcePreviewNodes = {};\n    this.sourcePreviewNodeOptions = {};\n    this.sourceNodes = {};\n    this.sourceNodeOptions = {};\n    this.enterLeaveCounter = new _EnterLeaveCounter2.default();\n    this.dragStartSourceIds = [];\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.currentDragSourceNodeOffset = null;\n    this.currentDragSourceNodeOffsetChanged = false;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.getSourceClientOffset = this.getSourceClientOffset.bind(this);\n    this.handleTopDragStart = this.handleTopDragStart.bind(this);\n    this.handleTopDragStartCapture = this.handleTopDragStartCapture.bind(this);\n    this.handleTopDragEndCapture = this.handleTopDragEndCapture.bind(this);\n    this.handleTopDragEnter = this.handleTopDragEnter.bind(this);\n    this.handleTopDragEnterCapture = this.handleTopDragEnterCapture.bind(this);\n    this.handleTopDragLeaveCapture = this.handleTopDragLeaveCapture.bind(this);\n    this.handleTopDragOver = this.handleTopDragOver.bind(this);\n    this.handleTopDragOverCapture = this.handleTopDragOverCapture.bind(this);\n    this.handleTopDrop = this.handleTopDrop.bind(this);\n    this.handleTopDropCapture = this.handleTopDropCapture.bind(this);\n    this.handleSelectStart = this.handleSelectStart.bind(this);\n    this.endDragIfSourceWasRemovedFromDOM = this.endDragIfSourceWasRemovedFromDOM.bind(this);\n    this.endDragNativeItem = this.endDragNativeItem.bind(this);\n    this.asyncEndDragNativeItem = this.asyncEndDragNativeItem.bind(this);\n    this.isNodeInDocument = this.isNodeInDocument.bind(this);\n  }\n\n  _createClass(HTML5Backend, [{\n    key: 'setup',\n    value: function setup() {\n      if (this.window === undefined) {\n        return;\n      }\n\n      if (this.window.__isReactDndBackendSetUp) {\n        throw new Error('Cannot have two HTML5 backends at the same time.');\n      }\n\n      this.window.__isReactDndBackendSetUp = true;\n      this.addEventListeners(this.window);\n    }\n  }, {\n    key: 'teardown',\n    value: function teardown() {\n      if (this.window === undefined) {\n        return;\n      }\n\n      this.window.__isReactDndBackendSetUp = false;\n      this.removeEventListeners(this.window);\n      this.clearCurrentDragSourceNode();\n\n      if (this.asyncEndDragFrameId) {\n        this.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n      }\n    }\n  }, {\n    key: 'addEventListeners',\n    value: function addEventListeners(target) {\n      // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n      if (!target.addEventListener) {\n        return;\n      }\n\n      target.addEventListener('dragstart', this.handleTopDragStart);\n      target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n      target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n      target.addEventListener('dragenter', this.handleTopDragEnter);\n      target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n      target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n      target.addEventListener('dragover', this.handleTopDragOver);\n      target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n      target.addEventListener('drop', this.handleTopDrop);\n      target.addEventListener('drop', this.handleTopDropCapture, true);\n    }\n  }, {\n    key: 'removeEventListeners',\n    value: function removeEventListeners(target) {\n      // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n      if (!target.removeEventListener) {\n        return;\n      }\n\n      target.removeEventListener('dragstart', this.handleTopDragStart);\n      target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n      target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n      target.removeEventListener('dragenter', this.handleTopDragEnter);\n      target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n      target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n      target.removeEventListener('dragover', this.handleTopDragOver);\n      target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n      target.removeEventListener('drop', this.handleTopDrop);\n      target.removeEventListener('drop', this.handleTopDropCapture, true);\n    }\n  }, {\n    key: 'connectDragPreview',\n    value: function connectDragPreview(sourceId, node, options) {\n      var _this = this;\n\n      this.sourcePreviewNodeOptions[sourceId] = options;\n      this.sourcePreviewNodes[sourceId] = node;\n      return function () {\n        delete _this.sourcePreviewNodes[sourceId];\n        delete _this.sourcePreviewNodeOptions[sourceId];\n      };\n    }\n  }, {\n    key: 'connectDragSource',\n    value: function connectDragSource(sourceId, node, options) {\n      var _this2 = this;\n\n      this.sourceNodes[sourceId] = node;\n      this.sourceNodeOptions[sourceId] = options;\n\n      var handleDragStart = function handleDragStart(e) {\n        return _this2.handleDragStart(e, sourceId);\n      };\n\n      var handleSelectStart = function handleSelectStart(e) {\n        return _this2.handleSelectStart(e, sourceId);\n      };\n\n      node.setAttribute('draggable', true);\n      node.addEventListener('dragstart', handleDragStart);\n      node.addEventListener('selectstart', handleSelectStart);\n      return function () {\n        delete _this2.sourceNodes[sourceId];\n        delete _this2.sourceNodeOptions[sourceId];\n        node.removeEventListener('dragstart', handleDragStart);\n        node.removeEventListener('selectstart', handleSelectStart);\n        node.setAttribute('draggable', false);\n      };\n    }\n  }, {\n    key: 'connectDropTarget',\n    value: function connectDropTarget(targetId, node) {\n      var _this3 = this;\n\n      var handleDragEnter = function handleDragEnter(e) {\n        return _this3.handleDragEnter(e, targetId);\n      };\n\n      var handleDragOver = function handleDragOver(e) {\n        return _this3.handleDragOver(e, targetId);\n      };\n\n      var handleDrop = function handleDrop(e) {\n        return _this3.handleDrop(e, targetId);\n      };\n\n      node.addEventListener('dragenter', handleDragEnter);\n      node.addEventListener('dragover', handleDragOver);\n      node.addEventListener('drop', handleDrop);\n      return function () {\n        node.removeEventListener('dragenter', handleDragEnter);\n        node.removeEventListener('dragover', handleDragOver);\n        node.removeEventListener('drop', handleDrop);\n      };\n    }\n  }, {\n    key: 'getCurrentSourceNodeOptions',\n    value: function getCurrentSourceNodeOptions() {\n      var sourceId = this.monitor.getSourceId();\n      var sourceNodeOptions = this.sourceNodeOptions[sourceId];\n      return (0, _defaults2.default)(sourceNodeOptions || {}, {\n        dropEffect: this.altKeyPressed ? 'copy' : 'move'\n      });\n    }\n  }, {\n    key: 'getCurrentDropEffect',\n    value: function getCurrentDropEffect() {\n      if (this.isDraggingNativeItem()) {\n        // It makes more sense to default to 'copy' for native resources\n        return 'copy';\n      }\n\n      return this.getCurrentSourceNodeOptions().dropEffect;\n    }\n  }, {\n    key: 'getCurrentSourcePreviewNodeOptions',\n    value: function getCurrentSourcePreviewNodeOptions() {\n      var sourceId = this.monitor.getSourceId();\n      var sourcePreviewNodeOptions = this.sourcePreviewNodeOptions[sourceId];\n      return (0, _defaults2.default)(sourcePreviewNodeOptions || {}, {\n        anchorX: 0.5,\n        anchorY: 0.5,\n        captureDraggingState: false\n      });\n    }\n  }, {\n    key: 'getSourceClientOffset',\n    value: function getSourceClientOffset(sourceId) {\n      return (0, _OffsetUtils.getNodeClientOffset)(this.sourceNodes[sourceId]);\n    }\n  }, {\n    key: 'isDraggingNativeItem',\n    value: function isDraggingNativeItem() {\n      var itemType = this.monitor.getItemType();\n      return Object.keys(NativeTypes).some(function (key) {\n        return NativeTypes[key] === itemType;\n      });\n    }\n  }, {\n    key: 'beginDragNativeItem',\n    value: function beginDragNativeItem(type) {\n      this.clearCurrentDragSourceNode();\n      var SourceType = (0, _NativeDragSources.createNativeDragSource)(type);\n      this.currentNativeSource = new SourceType();\n      this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n      this.actions.beginDrag([this.currentNativeHandle]);\n    }\n  }, {\n    key: 'asyncEndDragNativeItem',\n    value: function asyncEndDragNativeItem() {\n      this.asyncEndDragFrameId = this.window.requestAnimationFrame(this.endDragNativeItem);\n    }\n  }, {\n    key: 'endDragNativeItem',\n    value: function endDragNativeItem() {\n      if (!this.isDraggingNativeItem()) {\n        return;\n      }\n\n      this.actions.endDrag();\n      this.registry.removeSource(this.currentNativeHandle);\n      this.currentNativeHandle = null;\n      this.currentNativeSource = null;\n    }\n  }, {\n    key: 'isNodeInDocument',\n    value: function isNodeInDocument(node) {\n      // Check the node either in the main document or in the current context\n      return document.body.contains(node) || this.window ? this.window.document.body.contains(node) : false;\n    }\n  }, {\n    key: 'endDragIfSourceWasRemovedFromDOM',\n    value: function endDragIfSourceWasRemovedFromDOM() {\n      var node = this.currentDragSourceNode;\n\n      if (this.isNodeInDocument(node)) {\n        return;\n      }\n\n      if (this.clearCurrentDragSourceNode()) {\n        this.actions.endDrag();\n      }\n    }\n  }, {\n    key: 'setCurrentDragSourceNode',\n    value: function setCurrentDragSourceNode(node) {\n      var _this4 = this;\n\n      this.clearCurrentDragSourceNode();\n      this.currentDragSourceNode = node;\n      this.currentDragSourceNodeOffset = (0, _OffsetUtils.getNodeClientOffset)(node);\n      this.currentDragSourceNodeOffsetChanged = false; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n      // See:\n      //   * https://github.com/react-dnd/react-dnd/pull/928\n      //   * https://github.com/react-dnd/react-dnd/issues/869\n\n      var MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n      // means it has ended and the drag source node disappeared from DOM,\n      // so the browser didn't dispatch the dragend event.\n      //\n      // We need to wait before we start listening for mousemove events.\n      // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n      // immediately in some browsers.\n      //\n      // See:\n      //   * https://github.com/react-dnd/react-dnd/pull/928\n      //   * https://github.com/react-dnd/react-dnd/issues/869\n      //\n\n      this.mouseMoveTimeoutTimer = setTimeout(function () {\n        _this4.mouseMoveTimeoutId = null;\n        return _this4.window.addEventListener('mousemove', _this4.endDragIfSourceWasRemovedFromDOM, true);\n      }, MOUSE_MOVE_TIMEOUT);\n    }\n  }, {\n    key: 'clearCurrentDragSourceNode',\n    value: function clearCurrentDragSourceNode() {\n      if (this.currentDragSourceNode) {\n        this.currentDragSourceNode = null;\n        this.currentDragSourceNodeOffset = null;\n        this.currentDragSourceNodeOffsetChanged = false;\n        this.window.clearTimeout(this.mouseMoveTimeoutTimer);\n        this.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n        this.mouseMoveTimeoutTimer = null;\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: 'checkIfCurrentDragSourceRectChanged',\n    value: function checkIfCurrentDragSourceRectChanged() {\n      var node = this.currentDragSourceNode;\n\n      if (!node) {\n        return false;\n      }\n\n      if (this.currentDragSourceNodeOffsetChanged) {\n        return true;\n      }\n\n      this.currentDragSourceNodeOffsetChanged = !(0, _shallowEqual2.default)((0, _OffsetUtils.getNodeClientOffset)(node), this.currentDragSourceNodeOffset);\n      return this.currentDragSourceNodeOffsetChanged;\n    }\n  }, {\n    key: 'handleTopDragStartCapture',\n    value: function handleTopDragStartCapture() {\n      this.clearCurrentDragSourceNode();\n      this.dragStartSourceIds = [];\n    }\n  }, {\n    key: 'handleDragStart',\n    value: function handleDragStart(e, sourceId) {\n      this.dragStartSourceIds.unshift(sourceId);\n    }\n  }, {\n    key: 'handleTopDragStart',\n    value: function handleTopDragStart(e) {\n      var _this5 = this;\n\n      var dragStartSourceIds = this.dragStartSourceIds;\n      this.dragStartSourceIds = null;\n      var clientOffset = (0, _OffsetUtils.getEventClientOffset)(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n      if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n      } // Don't publish the source just yet (see why below)\n\n\n      this.actions.beginDrag(dragStartSourceIds, {\n        publishSource: false,\n        getSourceClientOffset: this.getSourceClientOffset,\n        clientOffset: clientOffset\n      });\n      var dataTransfer = e.dataTransfer;\n      var nativeType = (0, _NativeDragSources.matchNativeItemType)(dataTransfer);\n\n      if (this.monitor.isDragging()) {\n        if (typeof dataTransfer.setDragImage === 'function') {\n          // Use custom drag image if user specifies it.\n          // If child drag source refuses drag but parent agrees,\n          // use parent's node as drag image. Neither works in IE though.\n          var sourceId = this.monitor.getSourceId();\n          var sourceNode = this.sourceNodes[sourceId];\n          var dragPreview = this.sourcePreviewNodes[sourceId] || sourceNode;\n\n          var _getCurrentSourcePrev = this.getCurrentSourcePreviewNodeOptions(),\n              anchorX = _getCurrentSourcePrev.anchorX,\n              anchorY = _getCurrentSourcePrev.anchorY,\n              offsetX = _getCurrentSourcePrev.offsetX,\n              offsetY = _getCurrentSourcePrev.offsetY;\n\n          var anchorPoint = {\n            anchorX: anchorX,\n            anchorY: anchorY\n          };\n          var offsetPoint = {\n            offsetX: offsetX,\n            offsetY: offsetY\n          };\n          var dragPreviewOffset = (0, _OffsetUtils.getDragPreviewOffset)(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n          dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n        }\n\n        try {\n          // Firefox won't drag without setting data\n          dataTransfer.setData('application/json', {});\n        } catch (err) {} // IE doesn't support MIME types in setData\n        // Store drag source node so we can check whether\n        // it is removed from DOM and trigger endDrag manually.\n\n\n        this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n        var _getCurrentSourcePrev2 = this.getCurrentSourcePreviewNodeOptions(),\n            captureDraggingState = _getCurrentSourcePrev2.captureDraggingState;\n\n        if (!captureDraggingState) {\n          // Usually we want to publish it in the next tick so that browser\n          // is able to screenshot the current (not yet dragging) state.\n          //\n          // It also neatly avoids a situation where render() returns null\n          // in the same tick for the source element, and browser freaks out.\n          setTimeout(function () {\n            return _this5.actions.publishDragSource();\n          });\n        } else {\n          // In some cases the user may want to override this behavior, e.g.\n          // to work around IE not supporting custom drag previews.\n          //\n          // When using a custom drag layer, the only way to prevent\n          // the default drag preview from drawing in IE is to screenshot\n          // the dragging state in which the node itself has zero opacity\n          // and height. In this case, though, returning null from render()\n          // will abruptly end the dragging, which is not obvious.\n          //\n          // This is the reason such behavior is strictly opt-in.\n          this.actions.publishDragSource();\n        }\n      } else if (nativeType) {\n        // A native item (such as URL) dragged from inside the document\n        this.beginDragNativeItem(nativeType);\n      } else if (!dataTransfer.types && (!e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n        // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n        // Just let it drag. It's a native type (URL or text) and will be picked up in\n        // dragenter handler.\n        return; // eslint-disable-line no-useless-return\n      } else {\n        // If by this time no drag source reacted, tell browser not to drag.\n        e.preventDefault();\n      }\n    }\n  }, {\n    key: 'handleTopDragEndCapture',\n    value: function handleTopDragEndCapture() {\n      if (this.clearCurrentDragSourceNode()) {\n        // Firefox can dispatch this event in an infinite loop\n        // if dragend handler does something like showing an alert.\n        // Only proceed if we have not handled it already.\n        this.actions.endDrag();\n      }\n    }\n  }, {\n    key: 'handleTopDragEnterCapture',\n    value: function handleTopDragEnterCapture(e) {\n      this.dragEnterTargetIds = [];\n      var isFirstEnter = this.enterLeaveCounter.enter(e.target);\n\n      if (!isFirstEnter || this.monitor.isDragging()) {\n        return;\n      }\n\n      var dataTransfer = e.dataTransfer;\n      var nativeType = (0, _NativeDragSources.matchNativeItemType)(dataTransfer);\n\n      if (nativeType) {\n        // A native item (such as file or URL) dragged from outside the document\n        this.beginDragNativeItem(nativeType);\n      }\n    }\n  }, {\n    key: 'handleDragEnter',\n    value: function handleDragEnter(e, targetId) {\n      this.dragEnterTargetIds.unshift(targetId);\n    }\n  }, {\n    key: 'handleTopDragEnter',\n    value: function handleTopDragEnter(e) {\n      var _this6 = this;\n\n      var dragEnterTargetIds = this.dragEnterTargetIds;\n      this.dragEnterTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        return;\n      }\n\n      this.altKeyPressed = e.altKey;\n\n      if (!(0, _BrowserDetector.isFirefox)()) {\n        // Don't emit hover in `dragenter` on Firefox due to an edge case.\n        // If the target changes position as the result of `dragenter`, Firefox\n        // will still happily dispatch `dragover` despite target being no longer\n        // there. The easy solution is to only fire `hover` in `dragover` on FF.\n        this.actions.hover(dragEnterTargetIds, {\n          clientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n        });\n      }\n\n      var canDrop = dragEnterTargetIds.some(function (targetId) {\n        return _this6.monitor.canDropOnTarget(targetId);\n      });\n\n      if (canDrop) {\n        // IE requires this to fire dragover events\n        e.preventDefault();\n        e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n      }\n    }\n  }, {\n    key: 'handleTopDragOverCapture',\n    value: function handleTopDragOverCapture() {\n      this.dragOverTargetIds = [];\n    }\n  }, {\n    key: 'handleDragOver',\n    value: function handleDragOver(e, targetId) {\n      this.dragOverTargetIds.unshift(targetId);\n    }\n  }, {\n    key: 'handleTopDragOver',\n    value: function handleTopDragOver(e) {\n      var _this7 = this;\n\n      var dragOverTargetIds = this.dragOverTargetIds;\n      this.dragOverTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        // Prevent default \"drop and blow away the whole document\" action.\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'none';\n        return;\n      }\n\n      this.altKeyPressed = e.altKey;\n      this.actions.hover(dragOverTargetIds, {\n        clientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n      });\n      var canDrop = dragOverTargetIds.some(function (targetId) {\n        return _this7.monitor.canDropOnTarget(targetId);\n      });\n\n      if (canDrop) {\n        // Show user-specified drop effect.\n        e.preventDefault();\n        e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n      } else if (this.isDraggingNativeItem()) {\n        // Don't show a nice cursor but still prevent default\n        // \"drop and blow away the whole document\" action.\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'none';\n      } else if (this.checkIfCurrentDragSourceRectChanged()) {\n        // Prevent animating to incorrect position.\n        // Drop effect must be other than 'none' to prevent animation.\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'move';\n      }\n    }\n  }, {\n    key: 'handleTopDragLeaveCapture',\n    value: function handleTopDragLeaveCapture(e) {\n      if (this.isDraggingNativeItem()) {\n        e.preventDefault();\n      }\n\n      var isLastLeave = this.enterLeaveCounter.leave(e.target);\n\n      if (!isLastLeave) {\n        return;\n      }\n\n      if (this.isDraggingNativeItem()) {\n        this.endDragNativeItem();\n      }\n    }\n  }, {\n    key: 'handleTopDropCapture',\n    value: function handleTopDropCapture(e) {\n      this.dropTargetIds = [];\n      e.preventDefault();\n\n      if (this.isDraggingNativeItem()) {\n        this.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer);\n      }\n\n      this.enterLeaveCounter.reset();\n    }\n  }, {\n    key: 'handleDrop',\n    value: function handleDrop(e, targetId) {\n      this.dropTargetIds.unshift(targetId);\n    }\n  }, {\n    key: 'handleTopDrop',\n    value: function handleTopDrop(e) {\n      var dropTargetIds = this.dropTargetIds;\n      this.dropTargetIds = [];\n      this.actions.hover(dropTargetIds, {\n        clientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n      });\n      this.actions.drop({\n        dropEffect: this.getCurrentDropEffect()\n      });\n\n      if (this.isDraggingNativeItem()) {\n        this.endDragNativeItem();\n      } else {\n        this.endDragIfSourceWasRemovedFromDOM();\n      }\n    }\n  }, {\n    key: 'handleSelectStart',\n    value: function handleSelectStart(e) {\n      var target = e.target; // Only IE requires us to explicitly say\n      // we want drag drop operation to start\n\n      if (typeof target.dragDrop !== 'function') {\n        return;\n      } // Inputs and textareas should be selectable\n\n\n      if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n        return;\n      } // For other targets, ask IE\n      // to enable drag and drop\n\n\n      e.preventDefault();\n      target.dragDrop();\n    }\n  }, {\n    key: 'window',\n    get: function get() {\n      if (this.context && this.context.window) {\n        return this.context.window;\n      } else if (typeof window !== 'undefined') {\n        return window;\n      }\n\n      return undefined;\n    }\n  }]);\n\n  return HTML5Backend;\n}();\n\nexports.default = HTML5Backend;","map":{"version":3,"sources":["C:/Users/vincent/git/savagerow/front-end/node_modules/react-dnd-html5-backend/lib/HTML5Backend.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_defaults","require","_defaults2","_interopRequireDefault","_shallowEqual","_shallowEqual2","_EnterLeaveCounter","_EnterLeaveCounter2","_BrowserDetector","_OffsetUtils","_NativeDragSources","_NativeTypes","NativeTypes","_interopRequireWildcard","obj","__esModule","newObj","hasOwnProperty","call","default","_classCallCheck","instance","TypeError","HTML5Backend","manager","actions","getActions","monitor","getMonitor","registry","getRegistry","context","getContext","sourcePreviewNodes","sourcePreviewNodeOptions","sourceNodes","sourceNodeOptions","enterLeaveCounter","dragStartSourceIds","dropTargetIds","dragEnterTargetIds","currentNativeSource","currentNativeHandle","currentDragSourceNode","currentDragSourceNodeOffset","currentDragSourceNodeOffsetChanged","altKeyPressed","mouseMoveTimeoutTimer","getSourceClientOffset","bind","handleTopDragStart","handleTopDragStartCapture","handleTopDragEndCapture","handleTopDragEnter","handleTopDragEnterCapture","handleTopDragLeaveCapture","handleTopDragOver","handleTopDragOverCapture","handleTopDrop","handleTopDropCapture","handleSelectStart","endDragIfSourceWasRemovedFromDOM","endDragNativeItem","asyncEndDragNativeItem","isNodeInDocument","setup","window","undefined","__isReactDndBackendSetUp","Error","addEventListeners","teardown","removeEventListeners","clearCurrentDragSourceNode","asyncEndDragFrameId","cancelAnimationFrame","addEventListener","removeEventListener","connectDragPreview","sourceId","node","options","_this","connectDragSource","_this2","handleDragStart","e","setAttribute","connectDropTarget","targetId","_this3","handleDragEnter","handleDragOver","handleDrop","getCurrentSourceNodeOptions","getSourceId","dropEffect","getCurrentDropEffect","isDraggingNativeItem","getCurrentSourcePreviewNodeOptions","anchorX","anchorY","captureDraggingState","getNodeClientOffset","itemType","getItemType","keys","some","beginDragNativeItem","type","SourceType","createNativeDragSource","addSource","beginDrag","requestAnimationFrame","endDrag","removeSource","document","body","contains","setCurrentDragSourceNode","_this4","MOUSE_MOVE_TIMEOUT","setTimeout","mouseMoveTimeoutId","clearTimeout","checkIfCurrentDragSourceRectChanged","unshift","_this5","clientOffset","getEventClientOffset","isDragging","publishSource","dataTransfer","nativeType","matchNativeItemType","setDragImage","sourceNode","dragPreview","_getCurrentSourcePrev","offsetX","offsetY","anchorPoint","offsetPoint","dragPreviewOffset","getDragPreviewOffset","x","y","setData","err","_getCurrentSourcePrev2","publishDragSource","types","hasAttribute","preventDefault","isFirstEnter","enter","_this6","altKey","isFirefox","hover","canDrop","canDropOnTarget","dragOverTargetIds","_this7","isLastLeave","leave","mutateItemByReadingDataTransfer","reset","drop","dragDrop","tagName","isContentEditable","get"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /* eslint-disable no-underscore-dangle */\n\n\nvar _defaults = require('lodash/defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nvar _shallowEqual = require('./shallowEqual');\n\nvar _shallowEqual2 = _interopRequireDefault(_shallowEqual);\n\nvar _EnterLeaveCounter = require('./EnterLeaveCounter');\n\nvar _EnterLeaveCounter2 = _interopRequireDefault(_EnterLeaveCounter);\n\nvar _BrowserDetector = require('./BrowserDetector');\n\nvar _OffsetUtils = require('./OffsetUtils');\n\nvar _NativeDragSources = require('./NativeDragSources');\n\nvar _NativeTypes = require('./NativeTypes');\n\nvar NativeTypes = _interopRequireWildcard(_NativeTypes);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar HTML5Backend = function () {\n\tfunction HTML5Backend(manager) {\n\t\t_classCallCheck(this, HTML5Backend);\n\n\t\tthis.actions = manager.getActions();\n\t\tthis.monitor = manager.getMonitor();\n\t\tthis.registry = manager.getRegistry();\n\t\tthis.context = manager.getContext();\n\n\t\tthis.sourcePreviewNodes = {};\n\t\tthis.sourcePreviewNodeOptions = {};\n\t\tthis.sourceNodes = {};\n\t\tthis.sourceNodeOptions = {};\n\t\tthis.enterLeaveCounter = new _EnterLeaveCounter2.default();\n\n\t\tthis.dragStartSourceIds = [];\n\t\tthis.dropTargetIds = [];\n\t\tthis.dragEnterTargetIds = [];\n\t\tthis.currentNativeSource = null;\n\t\tthis.currentNativeHandle = null;\n\t\tthis.currentDragSourceNode = null;\n\t\tthis.currentDragSourceNodeOffset = null;\n\t\tthis.currentDragSourceNodeOffsetChanged = false;\n\t\tthis.altKeyPressed = false;\n\t\tthis.mouseMoveTimeoutTimer = null;\n\n\t\tthis.getSourceClientOffset = this.getSourceClientOffset.bind(this);\n\t\tthis.handleTopDragStart = this.handleTopDragStart.bind(this);\n\t\tthis.handleTopDragStartCapture = this.handleTopDragStartCapture.bind(this);\n\t\tthis.handleTopDragEndCapture = this.handleTopDragEndCapture.bind(this);\n\t\tthis.handleTopDragEnter = this.handleTopDragEnter.bind(this);\n\t\tthis.handleTopDragEnterCapture = this.handleTopDragEnterCapture.bind(this);\n\t\tthis.handleTopDragLeaveCapture = this.handleTopDragLeaveCapture.bind(this);\n\t\tthis.handleTopDragOver = this.handleTopDragOver.bind(this);\n\t\tthis.handleTopDragOverCapture = this.handleTopDragOverCapture.bind(this);\n\t\tthis.handleTopDrop = this.handleTopDrop.bind(this);\n\t\tthis.handleTopDropCapture = this.handleTopDropCapture.bind(this);\n\t\tthis.handleSelectStart = this.handleSelectStart.bind(this);\n\t\tthis.endDragIfSourceWasRemovedFromDOM = this.endDragIfSourceWasRemovedFromDOM.bind(this);\n\t\tthis.endDragNativeItem = this.endDragNativeItem.bind(this);\n\t\tthis.asyncEndDragNativeItem = this.asyncEndDragNativeItem.bind(this);\n\t\tthis.isNodeInDocument = this.isNodeInDocument.bind(this);\n\t}\n\n\t_createClass(HTML5Backend, [{\n\t\tkey: 'setup',\n\t\tvalue: function setup() {\n\t\t\tif (this.window === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.window.__isReactDndBackendSetUp) {\n\t\t\t\tthrow new Error('Cannot have two HTML5 backends at the same time.');\n\t\t\t}\n\t\t\tthis.window.__isReactDndBackendSetUp = true;\n\t\t\tthis.addEventListeners(this.window);\n\t\t}\n\t}, {\n\t\tkey: 'teardown',\n\t\tvalue: function teardown() {\n\t\t\tif (this.window === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.window.__isReactDndBackendSetUp = false;\n\t\t\tthis.removeEventListeners(this.window);\n\t\t\tthis.clearCurrentDragSourceNode();\n\t\t\tif (this.asyncEndDragFrameId) {\n\t\t\t\tthis.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'addEventListeners',\n\t\tvalue: function addEventListeners(target) {\n\t\t\t// SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n\t\t\tif (!target.addEventListener) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget.addEventListener('dragstart', this.handleTopDragStart);\n\t\t\ttarget.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n\t\t\ttarget.addEventListener('dragend', this.handleTopDragEndCapture, true);\n\t\t\ttarget.addEventListener('dragenter', this.handleTopDragEnter);\n\t\t\ttarget.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n\t\t\ttarget.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n\t\t\ttarget.addEventListener('dragover', this.handleTopDragOver);\n\t\t\ttarget.addEventListener('dragover', this.handleTopDragOverCapture, true);\n\t\t\ttarget.addEventListener('drop', this.handleTopDrop);\n\t\t\ttarget.addEventListener('drop', this.handleTopDropCapture, true);\n\t\t}\n\t}, {\n\t\tkey: 'removeEventListeners',\n\t\tvalue: function removeEventListeners(target) {\n\t\t\t// SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n\t\t\tif (!target.removeEventListener) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget.removeEventListener('dragstart', this.handleTopDragStart);\n\t\t\ttarget.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n\t\t\ttarget.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n\t\t\ttarget.removeEventListener('dragenter', this.handleTopDragEnter);\n\t\t\ttarget.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n\t\t\ttarget.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n\t\t\ttarget.removeEventListener('dragover', this.handleTopDragOver);\n\t\t\ttarget.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n\t\t\ttarget.removeEventListener('drop', this.handleTopDrop);\n\t\t\ttarget.removeEventListener('drop', this.handleTopDropCapture, true);\n\t\t}\n\t}, {\n\t\tkey: 'connectDragPreview',\n\t\tvalue: function connectDragPreview(sourceId, node, options) {\n\t\t\tvar _this = this;\n\n\t\t\tthis.sourcePreviewNodeOptions[sourceId] = options;\n\t\t\tthis.sourcePreviewNodes[sourceId] = node;\n\n\t\t\treturn function () {\n\t\t\t\tdelete _this.sourcePreviewNodes[sourceId];\n\t\t\t\tdelete _this.sourcePreviewNodeOptions[sourceId];\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: 'connectDragSource',\n\t\tvalue: function connectDragSource(sourceId, node, options) {\n\t\t\tvar _this2 = this;\n\n\t\t\tthis.sourceNodes[sourceId] = node;\n\t\t\tthis.sourceNodeOptions[sourceId] = options;\n\n\t\t\tvar handleDragStart = function handleDragStart(e) {\n\t\t\t\treturn _this2.handleDragStart(e, sourceId);\n\t\t\t};\n\t\t\tvar handleSelectStart = function handleSelectStart(e) {\n\t\t\t\treturn _this2.handleSelectStart(e, sourceId);\n\t\t\t};\n\n\t\t\tnode.setAttribute('draggable', true);\n\t\t\tnode.addEventListener('dragstart', handleDragStart);\n\t\t\tnode.addEventListener('selectstart', handleSelectStart);\n\n\t\t\treturn function () {\n\t\t\t\tdelete _this2.sourceNodes[sourceId];\n\t\t\t\tdelete _this2.sourceNodeOptions[sourceId];\n\n\t\t\t\tnode.removeEventListener('dragstart', handleDragStart);\n\t\t\t\tnode.removeEventListener('selectstart', handleSelectStart);\n\t\t\t\tnode.setAttribute('draggable', false);\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: 'connectDropTarget',\n\t\tvalue: function connectDropTarget(targetId, node) {\n\t\t\tvar _this3 = this;\n\n\t\t\tvar handleDragEnter = function handleDragEnter(e) {\n\t\t\t\treturn _this3.handleDragEnter(e, targetId);\n\t\t\t};\n\t\t\tvar handleDragOver = function handleDragOver(e) {\n\t\t\t\treturn _this3.handleDragOver(e, targetId);\n\t\t\t};\n\t\t\tvar handleDrop = function handleDrop(e) {\n\t\t\t\treturn _this3.handleDrop(e, targetId);\n\t\t\t};\n\n\t\t\tnode.addEventListener('dragenter', handleDragEnter);\n\t\t\tnode.addEventListener('dragover', handleDragOver);\n\t\t\tnode.addEventListener('drop', handleDrop);\n\n\t\t\treturn function () {\n\t\t\t\tnode.removeEventListener('dragenter', handleDragEnter);\n\t\t\t\tnode.removeEventListener('dragover', handleDragOver);\n\t\t\t\tnode.removeEventListener('drop', handleDrop);\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: 'getCurrentSourceNodeOptions',\n\t\tvalue: function getCurrentSourceNodeOptions() {\n\t\t\tvar sourceId = this.monitor.getSourceId();\n\t\t\tvar sourceNodeOptions = this.sourceNodeOptions[sourceId];\n\n\t\t\treturn (0, _defaults2.default)(sourceNodeOptions || {}, {\n\t\t\t\tdropEffect: this.altKeyPressed ? 'copy' : 'move'\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'getCurrentDropEffect',\n\t\tvalue: function getCurrentDropEffect() {\n\t\t\tif (this.isDraggingNativeItem()) {\n\t\t\t\t// It makes more sense to default to 'copy' for native resources\n\t\t\t\treturn 'copy';\n\t\t\t}\n\n\t\t\treturn this.getCurrentSourceNodeOptions().dropEffect;\n\t\t}\n\t}, {\n\t\tkey: 'getCurrentSourcePreviewNodeOptions',\n\t\tvalue: function getCurrentSourcePreviewNodeOptions() {\n\t\t\tvar sourceId = this.monitor.getSourceId();\n\t\t\tvar sourcePreviewNodeOptions = this.sourcePreviewNodeOptions[sourceId];\n\n\t\t\treturn (0, _defaults2.default)(sourcePreviewNodeOptions || {}, {\n\t\t\t\tanchorX: 0.5,\n\t\t\t\tanchorY: 0.5,\n\t\t\t\tcaptureDraggingState: false\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'getSourceClientOffset',\n\t\tvalue: function getSourceClientOffset(sourceId) {\n\t\t\treturn (0, _OffsetUtils.getNodeClientOffset)(this.sourceNodes[sourceId]);\n\t\t}\n\t}, {\n\t\tkey: 'isDraggingNativeItem',\n\t\tvalue: function isDraggingNativeItem() {\n\t\t\tvar itemType = this.monitor.getItemType();\n\t\t\treturn Object.keys(NativeTypes).some(function (key) {\n\t\t\t\treturn NativeTypes[key] === itemType;\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'beginDragNativeItem',\n\t\tvalue: function beginDragNativeItem(type) {\n\t\t\tthis.clearCurrentDragSourceNode();\n\n\t\t\tvar SourceType = (0, _NativeDragSources.createNativeDragSource)(type);\n\t\t\tthis.currentNativeSource = new SourceType();\n\t\t\tthis.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n\t\t\tthis.actions.beginDrag([this.currentNativeHandle]);\n\t\t}\n\t}, {\n\t\tkey: 'asyncEndDragNativeItem',\n\t\tvalue: function asyncEndDragNativeItem() {\n\t\t\tthis.asyncEndDragFrameId = this.window.requestAnimationFrame(this.endDragNativeItem);\n\t\t}\n\t}, {\n\t\tkey: 'endDragNativeItem',\n\t\tvalue: function endDragNativeItem() {\n\t\t\tif (!this.isDraggingNativeItem()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.actions.endDrag();\n\t\t\tthis.registry.removeSource(this.currentNativeHandle);\n\t\t\tthis.currentNativeHandle = null;\n\t\t\tthis.currentNativeSource = null;\n\t\t}\n\t}, {\n\t\tkey: 'isNodeInDocument',\n\t\tvalue: function isNodeInDocument(node) {\n\t\t\t// Check the node either in the main document or in the current context\n\t\t\treturn document.body.contains(node) || this.window ? this.window.document.body.contains(node) : false;\n\t\t}\n\t}, {\n\t\tkey: 'endDragIfSourceWasRemovedFromDOM',\n\t\tvalue: function endDragIfSourceWasRemovedFromDOM() {\n\t\t\tvar node = this.currentDragSourceNode;\n\t\t\tif (this.isNodeInDocument(node)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.clearCurrentDragSourceNode()) {\n\t\t\t\tthis.actions.endDrag();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'setCurrentDragSourceNode',\n\t\tvalue: function setCurrentDragSourceNode(node) {\n\t\t\tvar _this4 = this;\n\n\t\t\tthis.clearCurrentDragSourceNode();\n\t\t\tthis.currentDragSourceNode = node;\n\t\t\tthis.currentDragSourceNodeOffset = (0, _OffsetUtils.getNodeClientOffset)(node);\n\t\t\tthis.currentDragSourceNodeOffsetChanged = false;\n\n\t\t\t// A timeout of > 0 is necessary to resolve Firefox issue referenced\n\t\t\t// See:\n\t\t\t//   * https://github.com/react-dnd/react-dnd/pull/928\n\t\t\t//   * https://github.com/react-dnd/react-dnd/issues/869\n\t\t\tvar MOUSE_MOVE_TIMEOUT = 1000;\n\n\t\t\t// Receiving a mouse event in the middle of a dragging operation\n\t\t\t// means it has ended and the drag source node disappeared from DOM,\n\t\t\t// so the browser didn't dispatch the dragend event.\n\t\t\t//\n\t\t\t// We need to wait before we start listening for mousemove events.\n\t\t\t// This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n\t\t\t// immediately in some browsers.\n\t\t\t//\n\t\t\t// See:\n\t\t\t//   * https://github.com/react-dnd/react-dnd/pull/928\n\t\t\t//   * https://github.com/react-dnd/react-dnd/issues/869\n\t\t\t//\n\t\t\tthis.mouseMoveTimeoutTimer = setTimeout(function () {\n\t\t\t\t_this4.mouseMoveTimeoutId = null;\n\t\t\t\treturn _this4.window.addEventListener('mousemove', _this4.endDragIfSourceWasRemovedFromDOM, true);\n\t\t\t}, MOUSE_MOVE_TIMEOUT);\n\t\t}\n\t}, {\n\t\tkey: 'clearCurrentDragSourceNode',\n\t\tvalue: function clearCurrentDragSourceNode() {\n\t\t\tif (this.currentDragSourceNode) {\n\t\t\t\tthis.currentDragSourceNode = null;\n\t\t\t\tthis.currentDragSourceNodeOffset = null;\n\t\t\t\tthis.currentDragSourceNodeOffsetChanged = false;\n\t\t\t\tthis.window.clearTimeout(this.mouseMoveTimeoutTimer);\n\t\t\t\tthis.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n\t\t\t\tthis.mouseMoveTimeoutTimer = null;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}, {\n\t\tkey: 'checkIfCurrentDragSourceRectChanged',\n\t\tvalue: function checkIfCurrentDragSourceRectChanged() {\n\t\t\tvar node = this.currentDragSourceNode;\n\t\t\tif (!node) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.currentDragSourceNodeOffsetChanged) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.currentDragSourceNodeOffsetChanged = !(0, _shallowEqual2.default)((0, _OffsetUtils.getNodeClientOffset)(node), this.currentDragSourceNodeOffset);\n\n\t\t\treturn this.currentDragSourceNodeOffsetChanged;\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragStartCapture',\n\t\tvalue: function handleTopDragStartCapture() {\n\t\t\tthis.clearCurrentDragSourceNode();\n\t\t\tthis.dragStartSourceIds = [];\n\t\t}\n\t}, {\n\t\tkey: 'handleDragStart',\n\t\tvalue: function handleDragStart(e, sourceId) {\n\t\t\tthis.dragStartSourceIds.unshift(sourceId);\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragStart',\n\t\tvalue: function handleTopDragStart(e) {\n\t\t\tvar _this5 = this;\n\n\t\t\tvar dragStartSourceIds = this.dragStartSourceIds;\n\n\t\t\tthis.dragStartSourceIds = null;\n\n\t\t\tvar clientOffset = (0, _OffsetUtils.getEventClientOffset)(e);\n\n\t\t\t// Avoid crashing if we missed a drop event or our previous drag died\n\t\t\tif (this.monitor.isDragging()) {\n\t\t\t\tthis.actions.endDrag();\n\t\t\t}\n\n\t\t\t// Don't publish the source just yet (see why below)\n\t\t\tthis.actions.beginDrag(dragStartSourceIds, {\n\t\t\t\tpublishSource: false,\n\t\t\t\tgetSourceClientOffset: this.getSourceClientOffset,\n\t\t\t\tclientOffset: clientOffset\n\t\t\t});\n\n\t\t\tvar dataTransfer = e.dataTransfer;\n\n\t\t\tvar nativeType = (0, _NativeDragSources.matchNativeItemType)(dataTransfer);\n\n\t\t\tif (this.monitor.isDragging()) {\n\t\t\t\tif (typeof dataTransfer.setDragImage === 'function') {\n\t\t\t\t\t// Use custom drag image if user specifies it.\n\t\t\t\t\t// If child drag source refuses drag but parent agrees,\n\t\t\t\t\t// use parent's node as drag image. Neither works in IE though.\n\t\t\t\t\tvar sourceId = this.monitor.getSourceId();\n\t\t\t\t\tvar sourceNode = this.sourceNodes[sourceId];\n\t\t\t\t\tvar dragPreview = this.sourcePreviewNodes[sourceId] || sourceNode;\n\n\t\t\t\t\tvar _getCurrentSourcePrev = this.getCurrentSourcePreviewNodeOptions(),\n\t\t\t\t\t    anchorX = _getCurrentSourcePrev.anchorX,\n\t\t\t\t\t    anchorY = _getCurrentSourcePrev.anchorY,\n\t\t\t\t\t    offsetX = _getCurrentSourcePrev.offsetX,\n\t\t\t\t\t    offsetY = _getCurrentSourcePrev.offsetY;\n\n\t\t\t\t\tvar anchorPoint = { anchorX: anchorX, anchorY: anchorY };\n\t\t\t\t\tvar offsetPoint = { offsetX: offsetX, offsetY: offsetY };\n\t\t\t\t\tvar dragPreviewOffset = (0, _OffsetUtils.getDragPreviewOffset)(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n\n\t\t\t\t\tdataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// Firefox won't drag without setting data\n\t\t\t\t\tdataTransfer.setData('application/json', {});\n\t\t\t\t} catch (err) {}\n\t\t\t\t// IE doesn't support MIME types in setData\n\n\n\t\t\t\t// Store drag source node so we can check whether\n\t\t\t\t// it is removed from DOM and trigger endDrag manually.\n\t\t\t\tthis.setCurrentDragSourceNode(e.target);\n\n\t\t\t\t// Now we are ready to publish the drag source.. or are we not?\n\n\t\t\t\tvar _getCurrentSourcePrev2 = this.getCurrentSourcePreviewNodeOptions(),\n\t\t\t\t    captureDraggingState = _getCurrentSourcePrev2.captureDraggingState;\n\n\t\t\t\tif (!captureDraggingState) {\n\t\t\t\t\t// Usually we want to publish it in the next tick so that browser\n\t\t\t\t\t// is able to screenshot the current (not yet dragging) state.\n\t\t\t\t\t//\n\t\t\t\t\t// It also neatly avoids a situation where render() returns null\n\t\t\t\t\t// in the same tick for the source element, and browser freaks out.\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\treturn _this5.actions.publishDragSource();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// In some cases the user may want to override this behavior, e.g.\n\t\t\t\t\t// to work around IE not supporting custom drag previews.\n\t\t\t\t\t//\n\t\t\t\t\t// When using a custom drag layer, the only way to prevent\n\t\t\t\t\t// the default drag preview from drawing in IE is to screenshot\n\t\t\t\t\t// the dragging state in which the node itself has zero opacity\n\t\t\t\t\t// and height. In this case, though, returning null from render()\n\t\t\t\t\t// will abruptly end the dragging, which is not obvious.\n\t\t\t\t\t//\n\t\t\t\t\t// This is the reason such behavior is strictly opt-in.\n\t\t\t\t\tthis.actions.publishDragSource();\n\t\t\t\t}\n\t\t\t} else if (nativeType) {\n\t\t\t\t// A native item (such as URL) dragged from inside the document\n\t\t\t\tthis.beginDragNativeItem(nativeType);\n\t\t\t} else if (!dataTransfer.types && (!e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n\t\t\t\t// Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n\t\t\t\t// Just let it drag. It's a native type (URL or text) and will be picked up in\n\t\t\t\t// dragenter handler.\n\t\t\t\treturn; // eslint-disable-line no-useless-return\n\t\t\t} else {\n\t\t\t\t// If by this time no drag source reacted, tell browser not to drag.\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragEndCapture',\n\t\tvalue: function handleTopDragEndCapture() {\n\t\t\tif (this.clearCurrentDragSourceNode()) {\n\t\t\t\t// Firefox can dispatch this event in an infinite loop\n\t\t\t\t// if dragend handler does something like showing an alert.\n\t\t\t\t// Only proceed if we have not handled it already.\n\t\t\t\tthis.actions.endDrag();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragEnterCapture',\n\t\tvalue: function handleTopDragEnterCapture(e) {\n\t\t\tthis.dragEnterTargetIds = [];\n\n\t\t\tvar isFirstEnter = this.enterLeaveCounter.enter(e.target);\n\t\t\tif (!isFirstEnter || this.monitor.isDragging()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar dataTransfer = e.dataTransfer;\n\n\t\t\tvar nativeType = (0, _NativeDragSources.matchNativeItemType)(dataTransfer);\n\n\t\t\tif (nativeType) {\n\t\t\t\t// A native item (such as file or URL) dragged from outside the document\n\t\t\t\tthis.beginDragNativeItem(nativeType);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleDragEnter',\n\t\tvalue: function handleDragEnter(e, targetId) {\n\t\t\tthis.dragEnterTargetIds.unshift(targetId);\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragEnter',\n\t\tvalue: function handleTopDragEnter(e) {\n\t\t\tvar _this6 = this;\n\n\t\t\tvar dragEnterTargetIds = this.dragEnterTargetIds;\n\n\t\t\tthis.dragEnterTargetIds = [];\n\n\t\t\tif (!this.monitor.isDragging()) {\n\t\t\t\t// This is probably a native item type we don't understand.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.altKeyPressed = e.altKey;\n\n\t\t\tif (!(0, _BrowserDetector.isFirefox)()) {\n\t\t\t\t// Don't emit hover in `dragenter` on Firefox due to an edge case.\n\t\t\t\t// If the target changes position as the result of `dragenter`, Firefox\n\t\t\t\t// will still happily dispatch `dragover` despite target being no longer\n\t\t\t\t// there. The easy solution is to only fire `hover` in `dragover` on FF.\n\t\t\t\tthis.actions.hover(dragEnterTargetIds, {\n\t\t\t\t\tclientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar canDrop = dragEnterTargetIds.some(function (targetId) {\n\t\t\t\treturn _this6.monitor.canDropOnTarget(targetId);\n\t\t\t});\n\n\t\t\tif (canDrop) {\n\t\t\t\t// IE requires this to fire dragover events\n\t\t\t\te.preventDefault();\n\t\t\t\te.dataTransfer.dropEffect = this.getCurrentDropEffect();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragOverCapture',\n\t\tvalue: function handleTopDragOverCapture() {\n\t\t\tthis.dragOverTargetIds = [];\n\t\t}\n\t}, {\n\t\tkey: 'handleDragOver',\n\t\tvalue: function handleDragOver(e, targetId) {\n\t\t\tthis.dragOverTargetIds.unshift(targetId);\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragOver',\n\t\tvalue: function handleTopDragOver(e) {\n\t\t\tvar _this7 = this;\n\n\t\t\tvar dragOverTargetIds = this.dragOverTargetIds;\n\n\t\t\tthis.dragOverTargetIds = [];\n\n\t\t\tif (!this.monitor.isDragging()) {\n\t\t\t\t// This is probably a native item type we don't understand.\n\t\t\t\t// Prevent default \"drop and blow away the whole document\" action.\n\t\t\t\te.preventDefault();\n\t\t\t\te.dataTransfer.dropEffect = 'none';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.altKeyPressed = e.altKey;\n\n\t\t\tthis.actions.hover(dragOverTargetIds, {\n\t\t\t\tclientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n\t\t\t});\n\n\t\t\tvar canDrop = dragOverTargetIds.some(function (targetId) {\n\t\t\t\treturn _this7.monitor.canDropOnTarget(targetId);\n\t\t\t});\n\n\t\t\tif (canDrop) {\n\t\t\t\t// Show user-specified drop effect.\n\t\t\t\te.preventDefault();\n\t\t\t\te.dataTransfer.dropEffect = this.getCurrentDropEffect();\n\t\t\t} else if (this.isDraggingNativeItem()) {\n\t\t\t\t// Don't show a nice cursor but still prevent default\n\t\t\t\t// \"drop and blow away the whole document\" action.\n\t\t\t\te.preventDefault();\n\t\t\t\te.dataTransfer.dropEffect = 'none';\n\t\t\t} else if (this.checkIfCurrentDragSourceRectChanged()) {\n\t\t\t\t// Prevent animating to incorrect position.\n\t\t\t\t// Drop effect must be other than 'none' to prevent animation.\n\t\t\t\te.preventDefault();\n\t\t\t\te.dataTransfer.dropEffect = 'move';\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDragLeaveCapture',\n\t\tvalue: function handleTopDragLeaveCapture(e) {\n\t\t\tif (this.isDraggingNativeItem()) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\n\t\t\tvar isLastLeave = this.enterLeaveCounter.leave(e.target);\n\t\t\tif (!isLastLeave) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isDraggingNativeItem()) {\n\t\t\t\tthis.endDragNativeItem();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDropCapture',\n\t\tvalue: function handleTopDropCapture(e) {\n\t\t\tthis.dropTargetIds = [];\n\t\t\te.preventDefault();\n\n\t\t\tif (this.isDraggingNativeItem()) {\n\t\t\t\tthis.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer);\n\t\t\t}\n\n\t\t\tthis.enterLeaveCounter.reset();\n\t\t}\n\t}, {\n\t\tkey: 'handleDrop',\n\t\tvalue: function handleDrop(e, targetId) {\n\t\t\tthis.dropTargetIds.unshift(targetId);\n\t\t}\n\t}, {\n\t\tkey: 'handleTopDrop',\n\t\tvalue: function handleTopDrop(e) {\n\t\t\tvar dropTargetIds = this.dropTargetIds;\n\n\t\t\tthis.dropTargetIds = [];\n\n\t\t\tthis.actions.hover(dropTargetIds, {\n\t\t\t\tclientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n\t\t\t});\n\t\t\tthis.actions.drop({ dropEffect: this.getCurrentDropEffect() });\n\n\t\t\tif (this.isDraggingNativeItem()) {\n\t\t\t\tthis.endDragNativeItem();\n\t\t\t} else {\n\t\t\t\tthis.endDragIfSourceWasRemovedFromDOM();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'handleSelectStart',\n\t\tvalue: function handleSelectStart(e) {\n\t\t\tvar target = e.target;\n\n\t\t\t// Only IE requires us to explicitly say\n\t\t\t// we want drag drop operation to start\n\n\t\t\tif (typeof target.dragDrop !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Inputs and textareas should be selectable\n\t\t\tif (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For other targets, ask IE\n\t\t\t// to enable drag and drop\n\t\t\te.preventDefault();\n\t\t\ttarget.dragDrop();\n\t\t}\n\t}, {\n\t\tkey: 'window',\n\t\tget: function get() {\n\t\t\tif (this.context && this.context.window) {\n\t\t\t\treturn this.context.window;\n\t\t\t} else if (typeof window !== 'undefined') {\n\t\t\t\treturn window;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}]);\n\n\treturn HTML5Backend;\n}();\n\nexports.default = HTML5Backend;"]},"metadata":{},"sourceType":"script"}