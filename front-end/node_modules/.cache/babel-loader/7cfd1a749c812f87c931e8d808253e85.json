{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _invariant = require('invariant');\n\nvar _invariant2 = _interopRequireDefault(_invariant);\n\nvar _isArray = require('lodash/isArray');\n\nvar _isArray2 = _interopRequireDefault(_isArray);\n\nvar _asap = require('asap');\n\nvar _asap2 = _interopRequireDefault(_asap);\n\nvar _registry = require('./actions/registry');\n\nvar _getNextUniqueId = require('./utils/getNextUniqueId');\n\nvar _getNextUniqueId2 = _interopRequireDefault(_getNextUniqueId);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar HandlerRoles = {\n  SOURCE: 'SOURCE',\n  TARGET: 'TARGET'\n};\n\nfunction validateSourceContract(source) {\n  (0, _invariant2.default)(typeof source.canDrag === 'function', 'Expected canDrag to be a function.');\n  (0, _invariant2.default)(typeof source.beginDrag === 'function', 'Expected beginDrag to be a function.');\n  (0, _invariant2.default)(typeof source.endDrag === 'function', 'Expected endDrag to be a function.');\n}\n\nfunction validateTargetContract(target) {\n  (0, _invariant2.default)(typeof target.canDrop === 'function', 'Expected canDrop to be a function.');\n  (0, _invariant2.default)(typeof target.hover === 'function', 'Expected hover to be a function.');\n  (0, _invariant2.default)(typeof target.drop === 'function', 'Expected beginDrag to be a function.');\n}\n\nfunction validateType(type, allowArray) {\n  if (allowArray && (0, _isArray2.default)(type)) {\n    type.forEach(function (t) {\n      return validateType(t, false);\n    });\n    return;\n  }\n\n  (0, _invariant2.default)(typeof type === 'string' || (typeof type === 'undefined' ? 'undefined' : _typeof(type)) === 'symbol', allowArray ? 'Type can only be a string, a symbol, or an array of either.' : 'Type can only be a string or a symbol.');\n}\n\nfunction getNextHandlerId(role) {\n  var id = (0, _getNextUniqueId2.default)().toString();\n\n  switch (role) {\n    case HandlerRoles.SOURCE:\n      return 'S' + id;\n\n    case HandlerRoles.TARGET:\n      return 'T' + id;\n\n    default:\n      (0, _invariant2.default)(false, 'Unknown role: ' + role);\n  }\n}\n\nfunction parseRoleFromHandlerId(handlerId) {\n  switch (handlerId[0]) {\n    case 'S':\n      return HandlerRoles.SOURCE;\n\n    case 'T':\n      return HandlerRoles.TARGET;\n\n    default:\n      (0, _invariant2.default)(false, 'Cannot parse handler ID: ' + handlerId);\n  }\n}\n\nvar HandlerRegistry = function () {\n  function HandlerRegistry(store) {\n    _classCallCheck(this, HandlerRegistry);\n\n    this.store = store;\n    this.types = {};\n    this.handlers = {};\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n  }\n\n  _createClass(HandlerRegistry, [{\n    key: 'addSource',\n    value: function addSource(type, source) {\n      validateType(type);\n      validateSourceContract(source);\n      var sourceId = this.addHandler(HandlerRoles.SOURCE, type, source);\n      this.store.dispatch((0, _registry.addSource)(sourceId));\n      return sourceId;\n    }\n  }, {\n    key: 'addTarget',\n    value: function addTarget(type, target) {\n      validateType(type, true);\n      validateTargetContract(target);\n      var targetId = this.addHandler(HandlerRoles.TARGET, type, target);\n      this.store.dispatch((0, _registry.addTarget)(targetId));\n      return targetId;\n    }\n  }, {\n    key: 'addHandler',\n    value: function addHandler(role, type, handler) {\n      var id = getNextHandlerId(role);\n      this.types[id] = type;\n      this.handlers[id] = handler;\n      return id;\n    }\n  }, {\n    key: 'containsHandler',\n    value: function containsHandler(handler) {\n      var _this = this;\n\n      return Object.keys(this.handlers).some(function (key) {\n        return _this.handlers[key] === handler;\n      });\n    }\n  }, {\n    key: 'getSource',\n    value: function getSource(sourceId, includePinned) {\n      (0, _invariant2.default)(this.isSourceId(sourceId), 'Expected a valid source ID.');\n      var isPinned = includePinned && sourceId === this.pinnedSourceId;\n      var source = isPinned ? this.pinnedSource : this.handlers[sourceId];\n      return source;\n    }\n  }, {\n    key: 'getTarget',\n    value: function getTarget(targetId) {\n      (0, _invariant2.default)(this.isTargetId(targetId), 'Expected a valid target ID.');\n      return this.handlers[targetId];\n    }\n  }, {\n    key: 'getSourceType',\n    value: function getSourceType(sourceId) {\n      (0, _invariant2.default)(this.isSourceId(sourceId), 'Expected a valid source ID.');\n      return this.types[sourceId];\n    }\n  }, {\n    key: 'getTargetType',\n    value: function getTargetType(targetId) {\n      (0, _invariant2.default)(this.isTargetId(targetId), 'Expected a valid target ID.');\n      return this.types[targetId];\n    }\n  }, {\n    key: 'isSourceId',\n    value: function isSourceId(handlerId) {\n      var role = parseRoleFromHandlerId(handlerId);\n      return role === HandlerRoles.SOURCE;\n    }\n  }, {\n    key: 'isTargetId',\n    value: function isTargetId(handlerId) {\n      var role = parseRoleFromHandlerId(handlerId);\n      return role === HandlerRoles.TARGET;\n    }\n  }, {\n    key: 'removeSource',\n    value: function removeSource(sourceId) {\n      var _this2 = this;\n\n      (0, _invariant2.default)(this.getSource(sourceId), 'Expected an existing source.');\n      this.store.dispatch((0, _registry.removeSource)(sourceId));\n      (0, _asap2.default)(function () {\n        delete _this2.handlers[sourceId];\n        delete _this2.types[sourceId];\n      });\n    }\n  }, {\n    key: 'removeTarget',\n    value: function removeTarget(targetId) {\n      var _this3 = this;\n\n      (0, _invariant2.default)(this.getTarget(targetId), 'Expected an existing target.');\n      this.store.dispatch((0, _registry.removeTarget)(targetId));\n      (0, _asap2.default)(function () {\n        delete _this3.handlers[targetId];\n        delete _this3.types[targetId];\n      });\n    }\n  }, {\n    key: 'pinSource',\n    value: function pinSource(sourceId) {\n      var source = this.getSource(sourceId);\n      (0, _invariant2.default)(source, 'Expected an existing source.');\n      this.pinnedSourceId = sourceId;\n      this.pinnedSource = source;\n    }\n  }, {\n    key: 'unpinSource',\n    value: function unpinSource() {\n      (0, _invariant2.default)(this.pinnedSource, 'No source is pinned at the time.');\n      this.pinnedSourceId = null;\n      this.pinnedSource = null;\n    }\n  }]);\n\n  return HandlerRegistry;\n}();\n\nexports.default = HandlerRegistry;","map":{"version":3,"sources":["C:/Users/vincent/git/savagerow/front-end/node_modules/dnd-core/lib/HandlerRegistry.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_typeof","Symbol","iterator","obj","constructor","_invariant","require","_invariant2","_interopRequireDefault","_isArray","_isArray2","_asap","_asap2","_registry","_getNextUniqueId","_getNextUniqueId2","__esModule","default","_classCallCheck","instance","TypeError","HandlerRoles","SOURCE","TARGET","validateSourceContract","source","canDrag","beginDrag","endDrag","validateTargetContract","canDrop","hover","drop","validateType","type","allowArray","forEach","t","getNextHandlerId","role","id","toString","parseRoleFromHandlerId","handlerId","HandlerRegistry","store","types","handlers","pinnedSourceId","pinnedSource","addSource","sourceId","addHandler","dispatch","addTarget","targetId","handler","containsHandler","_this","keys","some","getSource","includePinned","isSourceId","isPinned","getTarget","isTargetId","getSourceType","getTargetType","removeSource","_this2","removeTarget","_this3","pinSource","unpinSource"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _invariant = require('invariant');\n\nvar _invariant2 = _interopRequireDefault(_invariant);\n\nvar _isArray = require('lodash/isArray');\n\nvar _isArray2 = _interopRequireDefault(_isArray);\n\nvar _asap = require('asap');\n\nvar _asap2 = _interopRequireDefault(_asap);\n\nvar _registry = require('./actions/registry');\n\nvar _getNextUniqueId = require('./utils/getNextUniqueId');\n\nvar _getNextUniqueId2 = _interopRequireDefault(_getNextUniqueId);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar HandlerRoles = {\n\tSOURCE: 'SOURCE',\n\tTARGET: 'TARGET'\n};\n\nfunction validateSourceContract(source) {\n\t(0, _invariant2.default)(typeof source.canDrag === 'function', 'Expected canDrag to be a function.');\n\t(0, _invariant2.default)(typeof source.beginDrag === 'function', 'Expected beginDrag to be a function.');\n\t(0, _invariant2.default)(typeof source.endDrag === 'function', 'Expected endDrag to be a function.');\n}\n\nfunction validateTargetContract(target) {\n\t(0, _invariant2.default)(typeof target.canDrop === 'function', 'Expected canDrop to be a function.');\n\t(0, _invariant2.default)(typeof target.hover === 'function', 'Expected hover to be a function.');\n\t(0, _invariant2.default)(typeof target.drop === 'function', 'Expected beginDrag to be a function.');\n}\n\nfunction validateType(type, allowArray) {\n\tif (allowArray && (0, _isArray2.default)(type)) {\n\t\ttype.forEach(function (t) {\n\t\t\treturn validateType(t, false);\n\t\t});\n\t\treturn;\n\t}\n\n\t(0, _invariant2.default)(typeof type === 'string' || (typeof type === 'undefined' ? 'undefined' : _typeof(type)) === 'symbol', allowArray ? 'Type can only be a string, a symbol, or an array of either.' : 'Type can only be a string or a symbol.');\n}\n\nfunction getNextHandlerId(role) {\n\tvar id = (0, _getNextUniqueId2.default)().toString();\n\tswitch (role) {\n\t\tcase HandlerRoles.SOURCE:\n\t\t\treturn 'S' + id;\n\t\tcase HandlerRoles.TARGET:\n\t\t\treturn 'T' + id;\n\t\tdefault:\n\t\t\t(0, _invariant2.default)(false, 'Unknown role: ' + role);\n\t}\n}\n\nfunction parseRoleFromHandlerId(handlerId) {\n\tswitch (handlerId[0]) {\n\t\tcase 'S':\n\t\t\treturn HandlerRoles.SOURCE;\n\t\tcase 'T':\n\t\t\treturn HandlerRoles.TARGET;\n\t\tdefault:\n\t\t\t(0, _invariant2.default)(false, 'Cannot parse handler ID: ' + handlerId);\n\t}\n}\n\nvar HandlerRegistry = function () {\n\tfunction HandlerRegistry(store) {\n\t\t_classCallCheck(this, HandlerRegistry);\n\n\t\tthis.store = store;\n\n\t\tthis.types = {};\n\t\tthis.handlers = {};\n\n\t\tthis.pinnedSourceId = null;\n\t\tthis.pinnedSource = null;\n\t}\n\n\t_createClass(HandlerRegistry, [{\n\t\tkey: 'addSource',\n\t\tvalue: function addSource(type, source) {\n\t\t\tvalidateType(type);\n\t\t\tvalidateSourceContract(source);\n\n\t\t\tvar sourceId = this.addHandler(HandlerRoles.SOURCE, type, source);\n\t\t\tthis.store.dispatch((0, _registry.addSource)(sourceId));\n\t\t\treturn sourceId;\n\t\t}\n\t}, {\n\t\tkey: 'addTarget',\n\t\tvalue: function addTarget(type, target) {\n\t\t\tvalidateType(type, true);\n\t\t\tvalidateTargetContract(target);\n\n\t\t\tvar targetId = this.addHandler(HandlerRoles.TARGET, type, target);\n\t\t\tthis.store.dispatch((0, _registry.addTarget)(targetId));\n\t\t\treturn targetId;\n\t\t}\n\t}, {\n\t\tkey: 'addHandler',\n\t\tvalue: function addHandler(role, type, handler) {\n\t\t\tvar id = getNextHandlerId(role);\n\t\t\tthis.types[id] = type;\n\t\t\tthis.handlers[id] = handler;\n\n\t\t\treturn id;\n\t\t}\n\t}, {\n\t\tkey: 'containsHandler',\n\t\tvalue: function containsHandler(handler) {\n\t\t\tvar _this = this;\n\n\t\t\treturn Object.keys(this.handlers).some(function (key) {\n\t\t\t\treturn _this.handlers[key] === handler;\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'getSource',\n\t\tvalue: function getSource(sourceId, includePinned) {\n\t\t\t(0, _invariant2.default)(this.isSourceId(sourceId), 'Expected a valid source ID.');\n\n\t\t\tvar isPinned = includePinned && sourceId === this.pinnedSourceId;\n\t\t\tvar source = isPinned ? this.pinnedSource : this.handlers[sourceId];\n\n\t\t\treturn source;\n\t\t}\n\t}, {\n\t\tkey: 'getTarget',\n\t\tvalue: function getTarget(targetId) {\n\t\t\t(0, _invariant2.default)(this.isTargetId(targetId), 'Expected a valid target ID.');\n\t\t\treturn this.handlers[targetId];\n\t\t}\n\t}, {\n\t\tkey: 'getSourceType',\n\t\tvalue: function getSourceType(sourceId) {\n\t\t\t(0, _invariant2.default)(this.isSourceId(sourceId), 'Expected a valid source ID.');\n\t\t\treturn this.types[sourceId];\n\t\t}\n\t}, {\n\t\tkey: 'getTargetType',\n\t\tvalue: function getTargetType(targetId) {\n\t\t\t(0, _invariant2.default)(this.isTargetId(targetId), 'Expected a valid target ID.');\n\t\t\treturn this.types[targetId];\n\t\t}\n\t}, {\n\t\tkey: 'isSourceId',\n\t\tvalue: function isSourceId(handlerId) {\n\t\t\tvar role = parseRoleFromHandlerId(handlerId);\n\t\t\treturn role === HandlerRoles.SOURCE;\n\t\t}\n\t}, {\n\t\tkey: 'isTargetId',\n\t\tvalue: function isTargetId(handlerId) {\n\t\t\tvar role = parseRoleFromHandlerId(handlerId);\n\t\t\treturn role === HandlerRoles.TARGET;\n\t\t}\n\t}, {\n\t\tkey: 'removeSource',\n\t\tvalue: function removeSource(sourceId) {\n\t\t\tvar _this2 = this;\n\n\t\t\t(0, _invariant2.default)(this.getSource(sourceId), 'Expected an existing source.');\n\t\t\tthis.store.dispatch((0, _registry.removeSource)(sourceId));\n\n\t\t\t(0, _asap2.default)(function () {\n\t\t\t\tdelete _this2.handlers[sourceId];\n\t\t\t\tdelete _this2.types[sourceId];\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'removeTarget',\n\t\tvalue: function removeTarget(targetId) {\n\t\t\tvar _this3 = this;\n\n\t\t\t(0, _invariant2.default)(this.getTarget(targetId), 'Expected an existing target.');\n\t\t\tthis.store.dispatch((0, _registry.removeTarget)(targetId));\n\n\t\t\t(0, _asap2.default)(function () {\n\t\t\t\tdelete _this3.handlers[targetId];\n\t\t\t\tdelete _this3.types[targetId];\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'pinSource',\n\t\tvalue: function pinSource(sourceId) {\n\t\t\tvar source = this.getSource(sourceId);\n\t\t\t(0, _invariant2.default)(source, 'Expected an existing source.');\n\n\t\t\tthis.pinnedSourceId = sourceId;\n\t\t\tthis.pinnedSource = source;\n\t\t}\n\t}, {\n\t\tkey: 'unpinSource',\n\t\tvalue: function unpinSource() {\n\t\t\t(0, _invariant2.default)(this.pinnedSource, 'No source is pinned at the time.');\n\n\t\t\tthis.pinnedSourceId = null;\n\t\t\tthis.pinnedSource = null;\n\t\t}\n\t}]);\n\n\treturn HandlerRegistry;\n}();\n\nexports.default = HandlerRegistry;"]},"metadata":{},"sourceType":"script"}