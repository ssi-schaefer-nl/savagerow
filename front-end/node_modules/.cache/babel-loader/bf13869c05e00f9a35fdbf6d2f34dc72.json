{"ast":null,"code":"function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport MenuItem from './MenuItem';\n\nvar AbstractMenu = function (_Component) {\n  _inherits(AbstractMenu, _Component);\n\n  function AbstractMenu(props) {\n    _classCallCheck(this, AbstractMenu);\n\n    var _this = _possibleConstructorReturn(this, (AbstractMenu.__proto__ || Object.getPrototypeOf(AbstractMenu)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.seletedItemRef = null;\n    _this.state = {\n      selectedItem: null,\n      forceSubMenuOpen: false\n    };\n    return _this;\n  }\n\n  return AbstractMenu;\n}(Component);\n\nAbstractMenu.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.handleKeyNavigation = function (e) {\n    // check for isVisible strictly here as it might be undefined when this code executes in the context of SubMenu\n    // but we only need to check when it runs in the ContextMenu context\n    if (_this2.state.isVisible === false) {\n      return;\n    }\n\n    switch (e.keyCode) {\n      case 37: // left arrow\n\n      case 27:\n        // escape\n        e.preventDefault();\n\n        _this2.hideMenu(e);\n\n        break;\n\n      case 38:\n        // up arrow\n        e.preventDefault();\n\n        _this2.selectChildren(true);\n\n        break;\n\n      case 40:\n        // down arrow\n        e.preventDefault();\n\n        _this2.selectChildren(false);\n\n        break;\n\n      case 39:\n        // right arrow\n        _this2.tryToOpenSubMenu(e);\n\n        break;\n\n      case 13:\n        // enter\n        e.preventDefault();\n\n        _this2.tryToOpenSubMenu(e);\n\n        {\n          // determine the selected item is disabled or not\n          var disabled = _this2.seletedItemRef && _this2.seletedItemRef.props && _this2.seletedItemRef.props.disabled;\n\n          if (_this2.seletedItemRef && _this2.seletedItemRef.ref instanceof HTMLElement && !disabled) {\n            _this2.seletedItemRef.ref.click();\n          } else {\n            _this2.hideMenu(e);\n          }\n        }\n        break;\n\n      default: // do nothing\n\n    }\n  };\n\n  this.handleForceClose = function () {\n    _this2.setState({\n      forceSubMenuOpen: false\n    });\n  };\n\n  this.tryToOpenSubMenu = function (e) {\n    if (_this2.state.selectedItem && _this2.state.selectedItem.type === _this2.getSubMenuType()) {\n      e.preventDefault();\n\n      _this2.setState({\n        forceSubMenuOpen: true\n      });\n    }\n  };\n\n  this.selectChildren = function (forward) {\n    var selectedItem = _this2.state.selectedItem;\n    var children = [];\n    var disabledChildrenCount = 0;\n    var disabledChildIndexes = {};\n\n    var childCollector = function childCollector(child, index) {\n      // child can be empty in case you do conditional rendering of components, in which\n      // case it should not be accounted for as a real child\n      if (!child) {\n        return;\n      }\n\n      if ([MenuItem, _this2.getSubMenuType()].indexOf(child.type) < 0) {\n        // Maybe the MenuItem or SubMenu is capsuled in a wrapper div or something else\n        React.Children.forEach(child.props.children, childCollector);\n      } else if (!child.props.divider) {\n        if (child.props.disabled) {\n          ++disabledChildrenCount;\n          disabledChildIndexes[index] = true;\n        }\n\n        children.push(child);\n      }\n    };\n\n    React.Children.forEach(_this2.props.children, childCollector);\n\n    if (disabledChildrenCount === children.length) {\n      // All menu items are disabled, so none can be selected, don't do anything\n      return;\n    }\n\n    function findNextEnabledChildIndex(currentIndex) {\n      var i = currentIndex;\n\n      var incrementCounter = function incrementCounter() {\n        if (forward) {\n          --i;\n        } else {\n          ++i;\n        }\n\n        if (i < 0) {\n          i = children.length - 1;\n        } else if (i >= children.length) {\n          i = 0;\n        }\n      };\n\n      do {\n        incrementCounter();\n      } while (i !== currentIndex && disabledChildIndexes[i]);\n\n      return i === currentIndex ? null : i;\n    }\n\n    var currentIndex = children.indexOf(selectedItem);\n    var nextEnabledChildIndex = findNextEnabledChildIndex(currentIndex);\n\n    if (nextEnabledChildIndex !== null) {\n      _this2.setState({\n        selectedItem: children[nextEnabledChildIndex],\n        forceSubMenuOpen: false\n      });\n    }\n  };\n\n  this.onChildMouseMove = function (child) {\n    if (_this2.state.selectedItem !== child) {\n      _this2.setState({\n        selectedItem: child,\n        forceSubMenuOpen: false\n      });\n    }\n  };\n\n  this.onChildMouseLeave = function () {\n    _this2.setState({\n      selectedItem: null,\n      forceSubMenuOpen: false\n    });\n  };\n\n  this.renderChildren = function (children) {\n    return React.Children.map(children, function (child) {\n      var props = {};\n      if (!React.isValidElement(child)) return child;\n\n      if ([MenuItem, _this2.getSubMenuType()].indexOf(child.type) < 0) {\n        // Maybe the MenuItem or SubMenu is capsuled in a wrapper div or something else\n        props.children = _this2.renderChildren(child.props.children);\n        return React.cloneElement(child, props);\n      }\n\n      props.onMouseLeave = _this2.onChildMouseLeave.bind(_this2);\n\n      if (child.type === _this2.getSubMenuType()) {\n        // special props for SubMenu only\n        props.forceOpen = _this2.state.forceSubMenuOpen && _this2.state.selectedItem === child;\n        props.forceClose = _this2.handleForceClose;\n        props.parentKeyNavigationHandler = _this2.handleKeyNavigation;\n      }\n\n      if (!child.props.divider && _this2.state.selectedItem === child) {\n        // special props for selected item only\n        props.selected = true;\n\n        props.ref = function (ref) {\n          _this2.seletedItemRef = ref;\n        };\n\n        return React.cloneElement(child, props);\n      } // onMouseMove is only needed for non selected items\n\n\n      props.onMouseMove = function () {\n        return _this2.onChildMouseMove(child);\n      };\n\n      return React.cloneElement(child, props);\n    });\n  };\n};\n\nexport default AbstractMenu;","map":{"version":3,"sources":["C:/Users/vincent/git/playground/node_modules/react-contextmenu/es6/AbstractMenu.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","React","Component","PropTypes","MenuItem","AbstractMenu","_Component","props","_this","getPrototypeOf","_initialiseProps","seletedItemRef","state","selectedItem","forceSubMenuOpen","propTypes","children","node","isRequired","_this2","handleKeyNavigation","e","isVisible","keyCode","preventDefault","hideMenu","selectChildren","tryToOpenSubMenu","disabled","ref","HTMLElement","click","handleForceClose","setState","type","getSubMenuType","forward","disabledChildrenCount","disabledChildIndexes","childCollector","child","index","indexOf","Children","forEach","divider","push","length","findNextEnabledChildIndex","currentIndex","i","incrementCounter","nextEnabledChildIndex","onChildMouseMove","onChildMouseLeave","renderChildren","map","isValidElement","cloneElement","onMouseLeave","bind","forceOpen","forceClose","parentKeyNavigationHandler","selected","onMouseMove"],"mappings":"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","sourcesContent":["function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport MenuItem from './MenuItem';\n\nvar AbstractMenu = function (_Component) {\n    _inherits(AbstractMenu, _Component);\n\n    function AbstractMenu(props) {\n        _classCallCheck(this, AbstractMenu);\n\n        var _this = _possibleConstructorReturn(this, (AbstractMenu.__proto__ || Object.getPrototypeOf(AbstractMenu)).call(this, props));\n\n        _initialiseProps.call(_this);\n\n        _this.seletedItemRef = null;\n        _this.state = {\n            selectedItem: null,\n            forceSubMenuOpen: false\n        };\n        return _this;\n    }\n\n    return AbstractMenu;\n}(Component);\n\nAbstractMenu.propTypes = {\n    children: PropTypes.node.isRequired\n};\n\nvar _initialiseProps = function _initialiseProps() {\n    var _this2 = this;\n\n    this.handleKeyNavigation = function (e) {\n        // check for isVisible strictly here as it might be undefined when this code executes in the context of SubMenu\n        // but we only need to check when it runs in the ContextMenu context\n        if (_this2.state.isVisible === false) {\n            return;\n        }\n\n        switch (e.keyCode) {\n            case 37: // left arrow\n            case 27:\n                // escape\n                e.preventDefault();\n                _this2.hideMenu(e);\n                break;\n            case 38:\n                // up arrow\n                e.preventDefault();\n                _this2.selectChildren(true);\n                break;\n            case 40:\n                // down arrow\n                e.preventDefault();\n                _this2.selectChildren(false);\n                break;\n            case 39:\n                // right arrow\n                _this2.tryToOpenSubMenu(e);\n                break;\n            case 13:\n                // enter\n                e.preventDefault();\n                _this2.tryToOpenSubMenu(e);\n                {\n                    // determine the selected item is disabled or not\n                    var disabled = _this2.seletedItemRef && _this2.seletedItemRef.props && _this2.seletedItemRef.props.disabled;\n\n                    if (_this2.seletedItemRef && _this2.seletedItemRef.ref instanceof HTMLElement && !disabled) {\n                        _this2.seletedItemRef.ref.click();\n                    } else {\n                        _this2.hideMenu(e);\n                    }\n                }\n                break;\n            default:\n            // do nothing\n        }\n    };\n\n    this.handleForceClose = function () {\n        _this2.setState({ forceSubMenuOpen: false });\n    };\n\n    this.tryToOpenSubMenu = function (e) {\n        if (_this2.state.selectedItem && _this2.state.selectedItem.type === _this2.getSubMenuType()) {\n            e.preventDefault();\n            _this2.setState({ forceSubMenuOpen: true });\n        }\n    };\n\n    this.selectChildren = function (forward) {\n        var selectedItem = _this2.state.selectedItem;\n\n        var children = [];\n        var disabledChildrenCount = 0;\n        var disabledChildIndexes = {};\n\n        var childCollector = function childCollector(child, index) {\n            // child can be empty in case you do conditional rendering of components, in which\n            // case it should not be accounted for as a real child\n            if (!child) {\n                return;\n            }\n\n            if ([MenuItem, _this2.getSubMenuType()].indexOf(child.type) < 0) {\n                // Maybe the MenuItem or SubMenu is capsuled in a wrapper div or something else\n                React.Children.forEach(child.props.children, childCollector);\n            } else if (!child.props.divider) {\n                if (child.props.disabled) {\n                    ++disabledChildrenCount;\n                    disabledChildIndexes[index] = true;\n                }\n\n                children.push(child);\n            }\n        };\n\n        React.Children.forEach(_this2.props.children, childCollector);\n        if (disabledChildrenCount === children.length) {\n            // All menu items are disabled, so none can be selected, don't do anything\n            return;\n        }\n\n        function findNextEnabledChildIndex(currentIndex) {\n            var i = currentIndex;\n            var incrementCounter = function incrementCounter() {\n                if (forward) {\n                    --i;\n                } else {\n                    ++i;\n                }\n\n                if (i < 0) {\n                    i = children.length - 1;\n                } else if (i >= children.length) {\n                    i = 0;\n                }\n            };\n\n            do {\n                incrementCounter();\n            } while (i !== currentIndex && disabledChildIndexes[i]);\n\n            return i === currentIndex ? null : i;\n        }\n\n        var currentIndex = children.indexOf(selectedItem);\n        var nextEnabledChildIndex = findNextEnabledChildIndex(currentIndex);\n\n        if (nextEnabledChildIndex !== null) {\n            _this2.setState({\n                selectedItem: children[nextEnabledChildIndex],\n                forceSubMenuOpen: false\n            });\n        }\n    };\n\n    this.onChildMouseMove = function (child) {\n        if (_this2.state.selectedItem !== child) {\n            _this2.setState({ selectedItem: child, forceSubMenuOpen: false });\n        }\n    };\n\n    this.onChildMouseLeave = function () {\n        _this2.setState({ selectedItem: null, forceSubMenuOpen: false });\n    };\n\n    this.renderChildren = function (children) {\n        return React.Children.map(children, function (child) {\n            var props = {};\n            if (!React.isValidElement(child)) return child;\n            if ([MenuItem, _this2.getSubMenuType()].indexOf(child.type) < 0) {\n                // Maybe the MenuItem or SubMenu is capsuled in a wrapper div or something else\n                props.children = _this2.renderChildren(child.props.children);\n                return React.cloneElement(child, props);\n            }\n            props.onMouseLeave = _this2.onChildMouseLeave.bind(_this2);\n            if (child.type === _this2.getSubMenuType()) {\n                // special props for SubMenu only\n                props.forceOpen = _this2.state.forceSubMenuOpen && _this2.state.selectedItem === child;\n                props.forceClose = _this2.handleForceClose;\n                props.parentKeyNavigationHandler = _this2.handleKeyNavigation;\n            }\n            if (!child.props.divider && _this2.state.selectedItem === child) {\n                // special props for selected item only\n                props.selected = true;\n                props.ref = function (ref) {\n                    _this2.seletedItemRef = ref;\n                };\n                return React.cloneElement(child, props);\n            }\n            // onMouseMove is only needed for non selected items\n            props.onMouseMove = function () {\n                return _this2.onChildMouseMove(child);\n            };\n            return React.cloneElement(child, props);\n        });\n    };\n};\n\nexport default AbstractMenu;"]},"metadata":{},"sourceType":"module"}